<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Siege Planner ‚Äì PoC</title>
    <link rel="stylesheet" href="/siege/style.css">
</head>
<body>
<header class="top-bar">
    <div class="logo-title">
        <div class="app-logo-circle"></div>
        <div class="title-text">
            Siege Planner
            <p class="subtitle">PoC realtime ‚Äì Raid Shadow Legends</p>
        </div>
    </div>

    <div class="room-controls">
        <div class="room-info">
            üîó <span id="currentRoomLabel">No Room</span>
            <button id="copyLinkBtn" class="ghost-btn">Copy Link</button>
            <button id="logoutBtn" class="ghost-btn" style="display: none;">Logout</button>
        </div>
        <div class="admin-controls" id="adminControls" style="display: none;">
            <button id="changePasswordBtn" class="ghost-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
                Change Passwords
            </button>
            <button id="exportDataBtn" class="ghost-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export
            </button>
            <button id="importDataBtn" class="ghost-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                Import
            </button>
            <input type="file" id="importFileInput" accept=".json" style="display: none;">
        </div>
    </div>
</header>

<main class="layout">
    <section class="map-section">
        <div class="map-filters-container">
            <!-- Filters Toggle Button -->
            <button id="filtersToggleBtn" class="filters-toggle-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                </svg>
                <span>Filters</span>
                <div id="clearFiltersBtn" class="clear-filters-icon-btn" title="Clear all filters">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <polyline points="1 20 1 14 7 14"></polyline>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                </div>
                <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>

            <!-- Filters Content (collapsible) -->
            <div id="filtersContent" class="filters-content">
                <div class="map-filter">
                    <label for="memberFilter">Member:</label>
                    <div class="custom-select-wrapper">
                        <div id="memberFilter" class="custom-select custom-select-no-icon">
                            <div class="custom-select-trigger">
                                <span>All</span>
                                <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="custom-select-options">
                                <div class="custom-select-option" data-value="">All</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="map-filter filter-condition-only">
                    <label for="conditionFilter">Condition:</label>
                    <div class="custom-select-wrapper">
                        <div id="conditionFilter" class="custom-select">
                            <div class="custom-select-trigger">
                                <span>All</span>
                                <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="custom-select-options">
                                <div class="custom-select-option" data-value="">All</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Display -->
                <div class="filters-stats filter-stats-only">
                    <div class="stat-item">
                        <img src="/siege/img/flags/defenses.webp" alt="Teams" class="stat-icon">
                        <span id="statTeams">0/0</span>
                    </div>
                    <div class="stat-item">
                        <img src="/siege/img/flags/bonuses.webp" alt="Bonuses" class="stat-icon">
                        <span id="statBonuses">0/28</span>
                    </div>
                    <div class="stat-item">
                        <img src="/siege/img/flags/traps.webp" alt="Traps" class="stat-icon">
                        <span id="statTraps">0/0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Teams Presets Toggle Button (Right side) -->
        <div class="teams-presets-toggle">
            <button id="teamsPresetsBtn" class="teams-presets-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <span>Teams</span>
                <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
            <div id="teamsPresetsDropdown" class="teams-presets-dropdown"></div>
        </div>

        <div class="map-container">
            <img src="/siege/img/Siege_Map.webp" class="map-img" alt="Siege Map">

            <div class="post-point" id="post1" data-post-id="post1" data-type="post">
                <div class="post-conditions">
                    <img class="post-cond-icon" data-index="0" src="/siege/img/conditions/Condition.webp">
                    <img class="post-cond-icon" data-index="1" src="/siege/img/conditions/Condition.webp">
                    <img class="post-cond-icon" data-index="2" src="/siege/img/conditions/Condition.webp">
                </div>
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 1</div>
            </div>
            <div class="post-point" id="post2" data-post-id="post2" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 2</div>
            </div>
            <div class="post-point" id="post3" data-post-id="post3" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 3</div>
            </div>
            <div class="post-point" id="post4" data-post-id="post4" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 4</div>
            </div>
            <div class="post-point" id="post5" data-post-id="post5" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 5</div>
            </div>
            <div class="post-point" id="post6" data-post-id="post6" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 6</div>
            </div>
            <div class="post-point" id="post7" data-post-id="post7" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 7</div>
            </div>
            <div class="post-point" id="post8" data-post-id="post8" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 8</div>
            </div>
            <div class="post-point" id="post9" data-post-id="post9" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 9</div>
            </div>
            <div class="post-point" id="post10" data-post-id="post10" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 10</div>
            </div>
            <div class="post-point" id="post11" data-post-id="post11" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 11</div>
            </div>
            <div class="post-point" id="post12" data-post-id="post12" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 12</div>
            </div>
            <div class="post-point" id="post13" data-post-id="post13" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 13</div>
            </div>
            <div class="post-point" id="post14" data-post-id="post14" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 14</div>
            </div>
            <div class="post-point" id="post15" data-post-id="post15" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 15</div>
            </div>
            <div class="post-point" id="post16" data-post-id="post16" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 16</div>
            </div>
            <div class="post-point" id="post17" data-post-id="post17" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 17</div>
            </div>
            <div class="post-point" id="post18" data-post-id="post18" data-type="post">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Post 18</div>
            </div>
            <div class="post-point" id="manashrine1" data-post-id="manashrine1" data-type="manashrine">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Mana Shrine 1</div>
            </div>
            <div class="post-point" id="manashrine2" data-post-id="manashrine2" data-type="manashrine">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Mana Shrine 2</div>
            </div>
            <div class="post-point" id="magictower1" data-post-id="magictower1" data-type="magictower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Magic Tower 1</div>
            </div>
            <div class="post-point" id="magictower2" data-post-id="magictower2" data-type="magictower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Magic Tower 2</div>
            </div>
            <div class="post-point" id="magictower3" data-post-id="magictower3" data-type="magictower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Magic Tower 3</div>
            </div>
            <div class="post-point" id="magictower4" data-post-id="magictower4" data-type="magictower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Magic Tower 4</div>
            </div>
            <div class="post-point" id="defensetower1" data-post-id="defensetower1" data-type="defensetower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Defense Tower 1</div>
            </div>
            <div class="post-point" id="defensetower2" data-post-id="defensetower2" data-type="defensetower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Defense Tower 2</div>
            </div>
            <div class="post-point" id="defensetower3" data-post-id="defensetower3" data-type="defensetower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Defense Tower 3</div>
            </div>
            <div class="post-point" id="defensetower4" data-post-id="defensetower4" data-type="defensetower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Defense Tower 4</div>
            </div>
            <div class="post-point" id="defensetower5" data-post-id="defensetower5" data-type="defensetower">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Defense Tower 5</div>
            </div>
            <div class="post-point" id="stronghold" data-post-id="stronghold" data-type="stronghold">
                <img class="post-icon">
                <img class="post-border" src="/siege/img/posts/border_post.webp">
                <div class="post-label">Stronghold</div>
            </div>
        </div>
    </section>
</main>

<section id="summarySection" class="summary-section">
    <h2 class="section-header collapsible" data-target="summaryContent">
        <span class="section-title" id="summaryTitle">TEAMS (0)</span>
        <svg class="collapse-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </h2>

    <div id="summaryContent" class="section-content">
        <table id="summaryTable">
            <thead>
                <tr>
                    <th class="sortable" data-sort="post">Post</th>
                    <th>Status</th>
                    <th>Group</th>
                    <th>Team</th>
                    <th>Sel.</th>
                    <th class="sortable" data-sort="conditions">Cond.</th>
                    <th class="sortable" data-sort="member">Member</th>
                    <th>HH</th>
                    <th>Champion 4</th>
                    <th>Champion 3</th>
                    <th>Champion 2</th>
                    <th>Lead</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</section>

<section id="membersSection" class="members-section">
    <h2 class="section-header collapsible" data-target="membersContent">
        <span class="section-title" id="membersTitle">Clan Members (0)</span>
        <svg class="collapse-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </h2>

    <div id="membersContent" class="section-content">
        <table id="membersTable">
            <thead>
                <tr>
                    <th class="sortable" data-sort="member">Member</th>
                    <th>HellHades Link</th>
                    <th class="sortable" data-sort="teams">Teams</th>
                    <th>Team Presets</th>
                    <th>Manage</th>
                </tr>
            </thead>
            <tbody id="membersTableBody"></tbody>
        </table>

        <div class="add-member">
            <input id="newMemberPseudo" placeholder="Pseudo">
            <input id="newMemberLink" placeholder="HellHades Optimizer Link (optional)">
            <button id="addMemberBtn">Add</button>
        </div>
    </div>
</section>

<!-- Modal -->
<div id="modalOverlay" class="modal-overlay">
    <div class="modal">
        <div class="modal-scrollable">
            <div class="modal-header">
                <button id="freezePostBtn" class="freeze-post-btn">
                    <span id="freezeIcon"></span>
                    <span id="freezeLabel">Lock</span>
                </button>
                <h2 id="modalTitle">Post</h2>
                <button id="closeModal" class="ghost-btn small">‚úï</button>
            </div>

            <!-- Building Level Input (only for buildings) -->
            <div id="buildingLevelSection" class="building-level-section" style="display: none;">
                <label for="buildingLevel" class="building-level-label">Building Level:</label>
                <select id="buildingLevel" class="building-level-select">
                    <option value="1">Level 1</option>
                    <option value="2">Level 2</option>
                    <option value="3">Level 3</option>
                    <option value="4">Level 4</option>
                    <option value="5">Level 5</option>
                    <option value="6">Level 6</option>
                </select>
                <div id="buildingLevelSlots" class="building-level-slots"></div>
            </div>

            <!-- Conditions -->
            <div class="field-group conditions-group">
            <div class="conditions-top-row">
                <button id="conditionToggle" type="button" class="condition-toggle">
                    <img id="conditionCurrentIcon" class="condition-current-icon" src="/siege/img/conditions/Condition.webp" alt="Condition" />
                </button>

                <div id="irradianceDisplay" class="irradiance-display"></div>

                <div id="strongholdBonusDisplay" class="stronghold-bonus-display">
                    <img id="strongholdBonusIcon" class="stronghold-bonus-icon" src="/siege/img/stronghold/Stronghold.webp" alt="Stronghold Bonus" />
                </div>

                <button id="conditionsPanelToggle" type="button" class="conditions-panel-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
            </div>

            <div id="conditionsPanel" class="conditions-panel"></div>

            <!-- Hidden value (condition id) -->
            <input type="hidden" id="condition" value="" />
            </div>

            <div class="modal-content">
                <!-- Teams -->
                <div class="teams-wrapper">
                    <div id="teamsContainer"></div>
                    <button id="addTeamBtn" class="ghost-btn add-team-btn">+ ADD TEAM</button>
                </div>
            </div>

            <p id="statusMsg" class="status auto-save-status"></p>
        </div>
    </div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="login-modal">
    <div class="login-modal-content">
        <div class="login-header">
            <h2>üîê Siege Planner Access</h2>
        </div>

        <div class="login-tabs">
            <button id="joinTab" class="login-tab active">Join Room</button>
            <button id="createTab" class="login-tab">Create Room</button>
        </div>

        <!-- Join Room Tab -->
        <div id="joinTabContent" class="login-tab-content active">
            <div class="login-field">
                <label>Room ID</label>
                <input type="text" id="joinRoomId" placeholder="Enter room ID">
            </div>

            <div class="login-field">
                <label>Password</label>
                <input type="password" id="joinPassword" placeholder="Enter password">
            </div>

            <div class="login-field">
                <label>Access Mode</label>
                <div class="access-mode-selector">
                    <button class="access-mode-btn active" data-mode="admin">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5"></path>
                            <path d="M2 12l10 5 10-5"></path>
                        </svg>
                        <span>Admin</span>
                        <small>Full access</small>
                    </button>
                    <button class="access-mode-btn" data-mode="viewer">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span>Viewer</span>
                        <small>Read only</small>
                    </button>
                </div>
            </div>

            <button id="joinRoomSubmit" class="login-submit-btn">Join Room</button>

            <div class="legacy-room-hint">
                <small>üí° Have an old room without password? Leave password empty to migrate it automatically.</small>
            </div>
        </div>

        <!-- Create Room Tab -->
        <div id="createTabContent" class="login-tab-content">
            <div class="login-field">
                <label>Room ID</label>
                <div class="room-id-input-group">
                    <input type="text" id="createRoomId" placeholder="Custom room ID (optional)">
                    <button id="generateRoomId" class="ghost-btn small">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                        </svg>
                        Generate
                    </button>
                </div>
            </div>

            <div class="login-field">
                <label>Admin Password</label>
                <input type="password" id="createAdminPassword" placeholder="Set admin password">
            </div>

            <div class="login-field">
                <label>Viewer Password</label>
                <input type="password" id="createViewerPassword" placeholder="Set viewer password">
            </div>

            <button id="createRoomSubmit" class="login-submit-btn">Create Room</button>
        </div>

        <div id="loginError" class="login-error"></div>
        <div id="loginStatus" class="login-status"></div>
    </div>
</div>

<!-- Change Password Modal -->
<div id="changePasswordModal" class="login-modal">
    <div class="login-modal-content">
        <div class="login-header">
            <h2>üîí Change Room Passwords</h2>
            <button id="closePasswordModal" class="modal-close-btn">‚úï</button>
        </div>

        <div class="password-change-content">
            <div class="login-field">
                <label>New Admin Password</label>
                <div class="password-input-wrapper">
                    <input type="password" id="newAdminPassword" placeholder="Enter new admin password">
                    <button type="button" class="password-toggle-btn" data-target="newAdminPassword">
                        <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="login-field">
                <label>Confirm Admin Password</label>
                <div class="password-input-wrapper">
                    <input type="password" id="confirmAdminPassword" placeholder="Confirm admin password">
                    <button type="button" class="password-toggle-btn" data-target="confirmAdminPassword">
                        <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="password-divider"></div>

            <div class="login-field">
                <label>New Viewer Password</label>
                <div class="password-input-wrapper">
                    <input type="password" id="newViewerPassword" placeholder="Enter new viewer password">
                    <button type="button" class="password-toggle-btn" data-target="newViewerPassword">
                        <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="login-field">
                <label>Confirm Viewer Password</label>
                <div class="password-input-wrapper">
                    <input type="password" id="confirmViewerPassword" placeholder="Confirm viewer password">
                    <button type="button" class="password-toggle-btn" data-target="confirmViewerPassword">
                        <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <button id="savePasswordsBtn" class="login-submit-btn">Save Passwords</button>

            <div class="password-warning">
                <small>‚ö†Ô∏è Make sure to save your new passwords! You won't be able to recover them.</small>
            </div>
        </div>

        <div id="passwordError" class="login-error"></div>
        <div id="passwordStatus" class="login-status"></div>
    </div>
</div>

<!-- Team Presets Modal -->
<div id="presetsModal" class="modal-overlay">
    <div class="presets-modal">
        <div class="presets-modal-scrollable">
            <div class="presets-modal-header">
                <h2 id="presetsModalTitle">Team Presets</h2>
                <button id="closePresetsModal" class="ghost-btn small">‚úï</button>
            </div>

            <div class="presets-modal-content">
                <div id="presetsContainer"></div>
                <button id="addPresetBtn" class="ghost-btn add-preset-btn">+ ADD TEAM PRESET</button>
            </div>
        </div>
    </div>
</div>

<!-- Blessing Selection Modal -->
<div id="blessingModal" class="modal blessing-modal">
    <div class="blessing-modal-overlay"></div>
    <div class="blessing-modal-content">
        <div class="blessing-modal-header">
            <h3 id="blessingModalTitle">Select Blessing</h3>
            <button id="closeBlessingModal" class="ghost-btn small">‚úï</button>
        </div>
        <div id="blessingModalBody" class="blessing-modal-body">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>
</div>

<!-- Scroll to Top Button -->
<button id="scrollToTopBtn" class="scroll-to-top-btn" title="Back to Map">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
</button>

<!-- sql.js (SQLite in browser) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
<!-- Script principal -->
<script type="module" src="/siege/script.js?v=20250112027"></script>
</body>
</html>
